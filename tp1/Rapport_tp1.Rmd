---
title: "Mathématique actuarielles IARD I  \n Travail pratique 1"
author: "Nicholas Langevin  \n Alexandre Turquotte"
date: '2018-10-26'
output: pdf_document
---

\newpage
# Question 1
### a) Estimation du coéficient d'asymétrie
 
```{R}
data <-  rexp(100, 1)

coef_asymetrie <- function(x){
    mu <- mean(x)
    sd <- sd(x)
    mean((x - mu)^3) / sd^3 
}

estimateur_coef_asymetrie <- coef_asymetrie(data)

hist(data, probability = TRUE,
     main = "Histograme des données",
     ylab = "Densité",
     xlab = "Données");curve(dexp(x,1), add = TRUE)
```


On apperçoit à l'aide de l'histograme que la masse de densité est concentré à gauche et la queue de la distribution va vers la droite. On s'attend donc à avoir un coéficient d'asymétrie possitif. En effet, le coéficient d'asymétrie estimé empiriquement est de `r estimateur_coef_asymetrie`. 

\newpage
### b) Interval de confiance pour le coéficient d'asymétrie
```{R}
teta <- mean(data)
echantillion <- lapply(1:50, function(i) rexp(50, teta))
coef_asymetrie_simul <- sapply(1:50, function(i) coef_asymetrie(echantillion[[i]]) )

mu_y <- mean(coef_asymetrie_simul)
variance_coef_asymetrie <- sum((coef_asymetrie_simul - mu_y)^2)

IC_y <- cbind(estimateur_coef_asymetrie - qnorm(0.975) * sqrt(variance_coef_asymetrie),
              estimateur_coef_asymetrie + qnorm(0.975) * sqrt(variance_coef_asymetrie))
```
Avec la méthode 'bootstrap', on obtient une variances estimé pour le coéficient d'asymétrie de `r variance_coef_asymetrie`, ce qui nous permet d'obtenir l'interval de confiance suivant:
\begin{align*}
[`r IC_y`]
\end{align*}

### c) Coeficient d'asymétrie théorique
Les moments de la loi expodentiel sont donnés par:

\begin{minipage}{5cm}
    \begin{align*}
        E[x]   &= \left. M_x^{'}(t) \right|_{t=0} \\
       &= \frac{d}{dt} \left.\left( \frac{\theta}{\theta - t} \right)\right|_{t=0} \\
       &= \left.\left( \frac{\theta}{(\theta - t)^B} \right)\right|_{t=0} \\
       &= \frac{1}{\theta}
    \end{align*}
\end{minipage}
\begin{minipage}{5cm}
    \begin{align*}
        E[x^2] &= \left. M_x^{''}(t) \right|_{t=0} \\
       &= \frac{d}{dt} \left.\left( \frac{\theta}{(\theta - t)^2} \right)\right|_{t=0} \\
       &= \left.\left( \frac{-2 \theta}{(\theta - t)^3} \right)\right|_{t=0} \\
       &= \frac{2}{\theta^2}
    \end{align*}
\end{minipage}
\begin{minipage}{5cm}
    \begin{align*}
        E[x^3] &= \left. M_x^{'''}(t) \right|_{t=0} \\
       &= \frac{d}{dt} \left.\left( \frac{-2 \theta}{(\theta - t)^3} \right)\right|_{t=0} \\
       &= \left.\left( \frac{6 \theta}{(\theta - t)^4} \right)\right|_{t=0} \\
       &= \frac{6}{\theta^3}
    \end{align*}
\end{minipage}

Ainsi, le coeficient d'asymétrie théorique est donnée par
\begin{align*}
    \gamma 
    &= E\left[ \frac{(x - \mu)^3}{\sigma^3} \right] \\
    &= \frac{1}{\sigma^3} \left( E[x^3 - 3x^2\mu + 3x\mu^2 - \mu^3] \right) \\
    &= \frac{1}{\sigma^3} \left( E[x^3] - 3\mu E[x^2] + 3\mu^2E[x] - \mu^3  \right) \\
    &= \theta^3 \left[ \frac{6}{\theta^3} - 3 \left(\frac{1}{\theta}\right) \left(\frac{2}{\theta^2}\right) + 3 \left(\frac{1}{\theta}\right)^3 - \left(\frac{1}{\theta}\right)^3 \right] \\
    &= \theta^3 \left[ \frac{6}{\theta^3} - \frac{6}{\theta^3} + \frac{2}{\theta^3} \right] \\
    &= 6 - 6 + 2 \\
    &= 2
\end{align*}


# Question 2
```{R}
plot(ecdf(data))
```













