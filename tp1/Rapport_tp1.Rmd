---
title: "TP1 ~ Mathématique actuarielles IARD I"
author: "Nicholas Langevin, Alexandre Turquotte"
date: '2018-10-05'
output: pdf_document
---
a) Le coéficient d’asymétrie estimé:
```{R}
n <- 100
data <-  rexp(n, 1)
 

mu <- mean(data)
sd <- sd(data)
mu_2 <- mean(data^2)
mu_3 <- mean(data^3)
cof_asymetrie <- (mu_3 - 3 * mu_2 * mu + 2 * mu^3)/sd^3



hist(data);curve(dexp(x,1) * n, add = TRUE)
```
\newpage

### c)Coeficient d'asymétrie théorique
Les moments de la loi expodentiel sont donnés par:

\begin{minipage}{5cm}
    \begin{align*}
        E[x]   &= \left. M_x^{'}(t) \right|_{t=0} \\
       &= \frac{d}{dt} \left.\left( \frac{\theta}{\theta - t} \right)\right|_{t=0} \\
       &= \left.\left( \frac{\theta}{(\theta - t)^B} \right)\right|_{t=0} \\
       &= \frac{1}{\theta}
    \end{align*}
\end{minipage}
\begin{minipage}{5cm}
    \begin{align*}
        E[x^2] &= \left. M_x^{''}(t) \right|_{t=0} \\
       &= \frac{d}{dt} \left.\left( \frac{\theta}{(\theta - t)^2} \right)\right|_{t=0} \\
       &= \left.\left( \frac{-2 \theta}{(\theta - t)^3} \right)\right|_{t=0} \\
       &= \frac{2}{\theta^2}
    \end{align*}
\end{minipage}
\begin{minipage}{5cm}
    \begin{align*}
        E[x^3] &= \left. M_x^{'''}(t) \right|_{t=0} \\
       &= \frac{d}{dt} \left.\left( \frac{-2 \theta}{(\theta - t)^3} \right)\right|_{t=0} \\
       &= \left.\left( \frac{6 \theta}{(\theta - t)^4} \right)\right|_{t=0} \\
       &= \frac{6}{\theta^3}
    \end{align*}
\end{minipage}

Ainsi, le coeficient d'asymétrie théorique est donnée par
\begin{align*}
    \gamma 
    &= E\left[ \frac{(x - \mu)^3}{\sigma^3} \right] \\
    &= \frac{1}{\sigma^3} \left( E[x^3 - 3x^2\mu + 3x\mu^2 - \mu^3] \right) \\
    &= \frac{1}{\sigma^3} \left( E[x^3] - 3\mu E[x^2] + 3\mu^2E[x] - \mu^3  \right) \\
    &= \theta^3 \left[ \frac{6}{\theta^3} - 3 \left(\frac{1}{\theta}\right) \left(\frac{2}{\theta^2}\right) + 3 \left(\frac{1}{\theta}\right)^3 - \left(\frac{1}{\theta}\right)^3 \right] \\
    &= \theta^3 \left[ \frac{6}{\theta^3} - \frac{6}{\theta^3} + \frac{2}{\theta^3} \right] \\
    &= 6 - 6 + 2 \\
    &= 2
\end{align*}


# Question 2
```{R}
rep_emp <- function(t){
    sum(data * (data <= t)) / n
}
plot_rep <- sapply(sort(data), rep_emp)
plot(plot_rep)
plot(ecdf(data))
```













